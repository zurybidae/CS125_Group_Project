#include <stdio.h>
#include <string.h>
#include <time.h>
#include <stdlib.h>
#include <ctype.h>
#include "guy_printer.h"

#define MAX 100

//00000000000000000000000 variables
char word[MAX];
char word2[MAX];
char filler[MAX];
char guess[MAX];
char word_bank[MAX];
int i,length, number, input;
int count=-1;
int wrong_guess=0;
int game_over=0;
int safe=0;
int b;


void word_picker(int x)//-----------------------------------------------------------------------------------------------------------------------------------------
{
  srand(time(NULL));
  int ran_num = rand()%5+1;

  if(x==1)    //animal
  {
    FILE *words = fopen("animal_words.txt","r");    
    for(i=0;i<ran_num;i++)
    {
        fgets(word,MAX,words);
    }
    
  }
  else if(x==2)  //places       
  {
    FILE *words = fopen("place_words.txt","r");    
    for(i=0;i<ran_num;i++)
    {
        fgets(word,MAX,words);
    }
    
  }
  else  //food 
  {
    FILE *words = fopen("food_words.txt","r");    
    for(i=0;i<ran_num;i++)
    {
        fgets(word,MAX,words);
    }

  }
  word[strcspn(word, "\n")] = '\0';      //from geeks for geeks
}



void letter_correct(char word2[])  //-----------------------------------------------------------------------------------------------------------------------------------------
{
    if(strlen(guess)>1)
    {
        if(strcmp(guess,word)==0)
        {
            game_over = 0;
            strcpy(word2,guess);
        }
        else
        {
            strcpy(guess,"7777");
        }
    }
    for (i=0; i<length; i++)
	{
		if (guess[0]==word[i])
		{
			
			word2[i]=guess[0];
			safe++;
		}
		
	}
}

void print(char word2[])  //-----------------------------------------------------------------------------------------------------------------------------------------
{
    
    for(i=0;i<length;i++)
    {
        if (word2[i]!='x')
        {
           printf("%c ", word2[i]);
           
        }
        else
        {
            printf("%c ", filler[i]);
        }
    }
}

    
int main() //-----------------------------------------------------------------------------------------------------------------------------------------
{
    char their_choice[10];
    int choice;
    printf("Welcome to Hangman!\n\n");
    
    printf("Chose a catagory of words:\n");
    do
	{
		printf("1) Animals  2) Places  3) Foods \n");
        scanf(" %s", their_choice); 
		
		if (!isdigit(their_choice[0]))
		{
			input=1;
			printf("That is not a number. Try Again.\n");
		}
		else if(strlen(their_choice)!=1)
        {
            printf("This is not a valid choice. Try Again.\n");
            input=1;
        }
		else if(their_choice[0]=='1')
		{
			choice=1;
			input=0;
		}
		else if(their_choice[0] =='2')
        {
            choice=2;
            input=0;
        }
        else if(their_choice[0] =='3')
        {
            choice=3;
            input=0;
        }
        else
        {
            printf("This is not a valid choice. Try Again.\n");
            input=1;
        }
	} while(input==1);
    
   
    word_picker(choice);

        
    length=strlen(word);
    int *size = &length;
    //printf("%d", *size);
    
    for(i=0;i<*size;i++)
    {
        filler[i]='_';
        printf("%c ", filler[i]);
    }

    for(i=0;i<*size;i++)
    {
        word2[i]='x';
    }
	

	do
	{
		do
		{
			count++;
			word_bank[count]=guess[0];
			if (count==0)
			{
			    printf("\n");
			}
			else 
			{
			    printf("\n\nletter guessed =");
			    for (b=0;b<7;b++)
			    {
			        printf("%c  ", word_bank[b]);
			    }
			}
			
			
			
			printf("\n\nGuess the letter:\n");
			
			
			scanf(" %s", guess);
			
			
			if (isdigit(guess[0]))
			{
				input=1;
				printf("That is not a letter. Try Again.\n");
			}
			else if(strlen(guess)>strlen(word))
			{
			    input=1;
				printf("That guess is too long. Try Again.\n");
			}
			else
			{
				input=0;
			}

		} while(input==1);
        
        
        letter_correct(word2);
        if(safe==0)
        {
            wrong_guess++;
        }
        safe=0;
		guy_printer(wrong_guess);
		if (wrong_guess==6)
		{
		game_over++;
		}
		print(word2);
		
		if(game_over==1)
		{
		    printf("\nGame Over");
		    printf("\nThe word was %s", word);
		    break;
		}
	}while(strcmp(word,word2)!=0);
	
	
	if(game_over ==0)
	{
	    printf("\nSuccess! You guessed the word! \n");
	}

	return 0;
}
